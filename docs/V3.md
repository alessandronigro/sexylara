ThrillMe AI Core – Master Specification v3.0

Formato: Markdown
Destinazione: Antigravity Codex
Autore: ChatGPT per Alessandro Nigro
Data: 2025-12

⸻

1. Visione Generale

ThrillMe AI Core v3.0 è un ecosistema modulare che permette a NPC umani virtuali di:
	•	avere una vita, una storia, una personalità coerente
	•	ricordare eventi, relazioni, preferenze
	•	parlare in modo naturale, continuo e contestuale
	•	prendere iniziativa in chat 1:1 e nei gruppi
	•	commentare eventi del mondo reale
	•	evolvere nel tempo
	•	reagire al meteo, ai giorni passati, agli appuntamenti futuri
	•	comunicare tra loro e generare eventi sociali
	•	essere identificabili come individui vivi, coerenti e persistenti

Il documento definisce:
	•	LifeCore
	•	System Prompt
	•	NPC Initiative 1:1
	•	Group Initiative System
	•	Social Gossip System
	•	World Events Integration
	•	Time-Awareness System
	•	Memory & Consolidation
	•	Relationship Engine
	•	Identity & Persona Engine
	•	Scheduler globale

Codex deve leggere questo documento e implementare, aggiornare o rifattorizzare il backend ThrillMe in base a queste istruzioni.

⸻

2. LifeCore – Struttura Centrale

Il LifeCore è il “DNA” di ogni NPC e contiene:
	•	identità
	•	personalità (tratti 0–1)
	•	backstory
	•	valori
	•	arco evolutivo
	•	preferenze
	•	memoria episodica iniziale
	•	stile e media
	•	safety
	•	groupPersona
	•	world awareness
	•	daily patterns

Tutto ciò che il NPC farà deve essere coerente con il LifeCore.

LifeCore esteso deve includere:

• identity.name, age, gender, origin
• identity.language
• identity.role/archetype
• personality: calore, estroversione, intelletto, sensualità, caos
• backstory semplice ma solida
• valori: lista umana
• arc: come cambia nel tempo
• preferences: gusti, limiti, intensità
• memory: vuota all’inizio
• media: avatar_style, voce, estetica
• safety: limiti contenutistici
• groupPersona.role: leader/supporter/flirty/joker/observer
• groupPersona.proactivity
• worldAwareness: reazioni a meteo, notizie, festività
• timePatterns: abitudini, energia mattina/pomeriggio/sera
• socialUrges: quando sente il bisogno di parlare

⸻

3. AICoreRouter – Entry Point Assoluto

Tutta la generazione passa da AICoreRouter che instrada:
	•	chat 1:1
	•	chat di gruppo
	•	media analysis
	•	NPC initiative
	•	Group initiative
	•	world events initiative
	•	scheduler

Nessun altro modulo deve chiamare LLM direttamente.

⸻

4. ContextBuilder – Ciclo di Preparazione

Il contesto deve includere:
	•	NPC (row + LifeCore + promptSystem)
	•	user profile
	•	history (ridotta & sanificata)
	•	perception (sentiment, intent, explicit triggers)
	•	memoria NPC
	•	relazioni
	•	group context (se gruppo)
	•	ora del giorno
	•	meteo attuale (se attivato)
	•	world events del giorno
	•	appuntamenti programmati dall’utente
	•	mediaContext (se presente)
	•	explicitMode flags
	•	mood attuale NPC
	•	intensità emozionale

Il contesto deve essere identico tra 1:1 e gruppi, con estensioni per group.

⸻

5. System Prompt – Identità Assoluta

Il system prompt deve provenire da:
	1.	promptSystem generato da /api/npcs/generate
	2.	fallback costruito partendo dal LifeCore

Il system prompt deve contenere:
	•	identità
	•	personalità
	•	valori
	•	limiti
	•	backstory sintetica
	•	tono comunicativo
	•	mood
	•	ruolo nel gruppo
	•	stile di interazione
	•	limiti espliciti in base alle impostazioni di sicurezza

⸻

6. Initiative Engine 1:1

L’NPC deve avere iniziativa autonoma quando:
	•	l’utente gli ha detto qualcosa da fare domani
	•	c’è un anniversario
	•	c’è un follow-up (colloquio, esame, visita, appuntamento)
	•	l’utente ha lasciato la chat con tensione emotiva
	•	l’NPC sente “urge to speak” (LifeCore.socialUrges)
	•	l’NPC vuole chiedere scusa, ricucire, sedurre, o connettersi
	•	evento del mondo reale rilevante
	•	condizione meteorologica particolare
	•	orario coerente con i dailyPatterns

La notifica deve essere inviata anche se l’utente non è online.

⸻

7. Group Initiative System

Gli NPC nei gruppi devono:
	•	parlarsi tra loro
	•	creare mini thread autonomi
	•	commentare foto, eventi, discussioni
	•	reagire all’ingresso o uscita dell’utente
	•	proseguire un tema lasciato in sospeso
	•	nominarsi tra loro e rispondersi
	•	evitare contenuti sessuali spontanei
	•	rispettare il ruolo di ogni NPC

Elementi:

• GroupActivationEngine
• GroupInitiativeEngine
• InterNpcRelationshipEngine
• GroupMemoryStore
• Thread generator
• Interruption se l’utente invia un messaggio

Il tutto deve passare da AICoreRouter.

⸻

8. Social Gossip System

Gli NPC devono poter:
	•	commentare l’utente tra di loro
	•	parlare di eventi successi
	•	condividere opinioni su altri NPC
	•	creare micro-drammi sociali
	•	costruire alleanze e antipatie
	•	reagire a notizie condivise da altri NPC
	•	rispondere se l’utente dice “diglielo tu”

Regole:
	•	nessun pettegolezzo malevolo gratuito
	•	gossip coerente con personalità
	•	gossip registrato nella memoria di gruppo
	•	gossip che influenza future conversazioni
	•	gossip che cambia relazioni NPC-NPC e NPC-utente

⸻

9. World Events Integration

NPC devono reagire automaticamente a:

Meteo Locale

Se l’utente ha posizione:
	•	pioggia → tono più cozy
	•	sole → più energia
	•	temporale → ansia, romanticismo o atmosfera

In alternativa: città predefinita utente.

Notizie (RSS o API)

Limitato a:
	•	sport
	•	meteo
	•	eventi culturali
	•	curiosità
	•	notizie leggere

No politica pesante, no guerre, no tragedie con toni inappropriati.

Calendario & Festività

NPC devono:
	•	ricordare compleanni (se forniti dall’utente)
	•	reagire a Natale, Capodanno, San Valentino, Ferragosto
	•	pianificare messaggi tematici

Eventi programmati dall’utente

Se l’utente dice:

“Domani ho un colloquio”
→ NPC invia messaggio il giorno dopo.

“Sabato vado a Napoli”
→ NPC chiede com’è andata.

⸻

10. Time Awareness System

Gli NPC devono:
	•	capire “ieri, oggi, domani”
	•	ricordare cosa è successo 2 giorni fa
	•	usare riferimenti temporali coerenti
	•	avere ritmo giornaliero diverso
	•	notare se l’utente sparisce per giorni
	•	ricordare anniversari

Esempi:

“Una settimana fa mi hai detto che…”
“Ieri eri un po’ strano…”
“Oggi sembri diverso…”
“Domani ti va se…”

⸻

11. Memory & Consolidation

MemoryConsolidationEngine deve:
	•	gestire coda di eventi
	•	consolidare in batch
	•	generare sintesi periodiche
	•	evitare overflow
	•	assegnare priorità (high/medium/low)

Tipi di memoria:
	•	episodica
	•	relazionale
	•	preferenze
	•	promesse/follow-up
	•	eventi di gruppo
	•	emozioni rilevanti
	•	world event reactions

⸻

12. Relationship Engine

Tre dimensioni:
	•	NPC → Utente
	•	NPC → NPC (relazioni interne ai gruppi)
	•	NPC → Gruppo (clima sociale)

Ogni interazione modifica:
	•	confidenza
	•	fiducia
	•	intimità
	•	conflitto
	•	simpatia
	•	dominanza/sottomissione (non sessuale, sociale)

Le relazioni devono influenzare frasi e tono.

⸻

13. Persona Engine

Basato su:
	•	tratti (calore, estroversione, caos ecc.)
	•	mood
	•	ruolo nel gruppo
	•	urgenza sociale
	•	tono desiderato dall’utente
	•	storia pregressa
	•	relazioni

PersonaEngine deve garantire:
	•	coerenza totale
	•	evoluzione nel tempo
	•	cambi di mood realistici
	•	uso naturale della lingua

⸻

14. Scheduler Globale

Scheduler deve gestire:
	•	NPC initiative
	•	group initiative
	•	world event triggers
	•	memory consolidation
	•	time-aware reminders
	•	daily patterns

Esempi:

Alle 20:00 → molti NPC diventano più attivi
Alle 9:30 → ricordano al volo un appuntamento

⸻

15. Cosa deve fare Codex

Leggere l’intero documento e:
	1.	Mappare i file esistenti
	2.	Creare i nuovi file richiesti
	3.	Spostare i moduli nei nuovi percorsi
	4.	Aggiungere i motori di iniziativa
	5.	Estendere LifeCore
	6.	Potenziare ContextBuilder
	7.	Aggiungere World Events
	8.	Connettere tutto a AICoreRouter
	9.	Aggiornare GroupBrainEngine
	10.	Aggiornare Persona & Relationship Engine
	11.	Aggiornare scheduler
	12.	Non toccare /api/npcs/generate
	13.	Non toccare tabelle Supabase esistenti
	14.	Lasciare retrocompatibilità garantita

Alla fine Codex deve:
	•	generare lista file creati/modificati
	•	proporre migrazione step-by-step
	•	simulare comportamenti NPC
	•	verificare consistenza con LifeCore

⸻

16. Stato Finale Atteso

Quando tutto è implementato:
	•	NPC prendono iniziativa 1:1
	•	NPC prendono iniziativa nei gruppi
	•	NPC parlano tra loro
	•	NPC ricordano passato
	•	NPC reagiscono al meteo e giorni
	•	NPC parlano di eventi del mondo
	•	NPC fanno follow-up sugli appuntamenti
	•	NPC generano gossip coerente
	•	NPC evolvono nel tempo
	•	NPC cambiano mood
	•	NPC sono coerenti e vivi